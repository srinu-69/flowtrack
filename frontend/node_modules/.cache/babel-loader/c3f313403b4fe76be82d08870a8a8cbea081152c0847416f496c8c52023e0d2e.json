{"ast":null,"code":"const API_URL = \"http://localhost:8000\"; // FastAPI backend base URL\n\n// Map backend status -> frontend status\nconst mapStatusOut = s => {\n  var _m$s;\n  if (!s) return s;\n  const m = {\n    Open: \"active\",\n    Assigned: \"maintenance\",\n    Closed: \"inactive\"\n  };\n  return (_m$s = m[s]) !== null && _m$s !== void 0 ? _m$s : String(s).toLowerCase();\n};\n\n// Map frontend status -> backend status\nconst mapStatusIn = s => {\n  var _m$s2;\n  if (!s) return s;\n  const m = {\n    active: \"Open\",\n    maintenance: \"Assigned\",\n    inactive: \"Closed\"\n  };\n  return (_m$s2 = m[s]) !== null && _m$s2 !== void 0 ? _m$s2 : s;\n};\nconst mapOut = item => {\n  var _ref, _ref2, _item$openDate, _ref3, _item$closeDate, _ref4, _item$description, _ref5, _ref6, _item$id;\n  if (!item) return item;\n  // normalize field names to frontend expectations\n  const openDate = (_ref = (_ref2 = (_item$openDate = item.openDate) !== null && _item$openDate !== void 0 ? _item$openDate : item.open_date) !== null && _ref2 !== void 0 ? _ref2 : item.open_date_time) !== null && _ref !== void 0 ? _ref : null;\n  const closeDate = (_ref3 = (_item$closeDate = item.closeDate) !== null && _item$closeDate !== void 0 ? _item$closeDate : item.close_date) !== null && _ref3 !== void 0 ? _ref3 : null;\n  const description = (_ref4 = (_item$description = item.description) !== null && _item$description !== void 0 ? _item$description : item.desc) !== null && _ref4 !== void 0 ? _ref4 : null;\n  const id = (_ref5 = (_ref6 = (_item$id = item.id) !== null && _item$id !== void 0 ? _item$id : item.asset_id) !== null && _ref6 !== void 0 ? _ref6 : item.pk) !== null && _ref5 !== void 0 ? _ref5 : null;\n  return {\n    ...item,\n    id,\n    status: mapStatusOut(item.status),\n    openDate,\n    closeDate,\n    description\n  };\n};\nexport async function listAssets(userEmail = null) {\n  const url = userEmail ? `${API_URL}/assets?user_email=${encodeURIComponent(userEmail)}` : `${API_URL}/assets`;\n  const res = await fetch(url);\n  if (!res.ok) throw new Error(\"Failed to fetch assets\");\n  const data = await res.json();\n\n  // Backend may return either an array or an envelope { value: [...] }\n  let assets = [];\n  if (Array.isArray(data)) assets = data.map(mapOut);else if (data && Array.isArray(data.value)) assets = data.value.map(mapOut);\n  // fallback: try common shapes\n  else if (data && Array.isArray(data.items)) assets = data.items.map(mapOut);\n\n  // Frontend safety filter by user email if provided\n  if (userEmail) {\n    assets = assets.filter(a => a.email === userEmail);\n  }\n  return assets;\n}\nexport async function addAsset(asset) {\n  // Send only the fields the backend schema expects (frontend status values)\n  const toSend = {\n    email: asset.email,\n    type: asset.type,\n    location: asset.location,\n    status: asset.status,\n    description: asset.description\n  };\n  const res = await fetch(`${API_URL}/assets`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify(toSend)\n  });\n  if (!res.ok) throw new Error(\"Failed to add asset\");\n  const data = await res.json();\n  // normalize returned asset(s)\n  if (Array.isArray(data)) return data.map(mapOut);\n  if (data && data.value) return data.value.map(mapOut);\n  if (data && data.id) return mapOut(data);\n  return data;\n}\nexport async function deleteAsset(id) {\n  const res = await fetch(`${API_URL}/assets/${id}`, {\n    method: \"DELETE\"\n  });\n  if (!res.ok) throw new Error(\"Failed to delete asset\");\n  const data = await res.json();\n  return data;\n}\nexport async function updateAsset(id, patch) {\n  // Send only the fields expected by backend\n  const toSend = {\n    ...(patch.email !== undefined ? {\n      email: patch.email\n    } : {}),\n    ...(patch.type !== undefined ? {\n      type: patch.type\n    } : {}),\n    ...(patch.location !== undefined ? {\n      location: patch.location\n    } : {}),\n    ...(patch.status !== undefined ? {\n      status: patch.status\n    } : {}),\n    ...(patch.description !== undefined ? {\n      description: patch.description\n    } : {})\n  };\n  const res = await fetch(`${API_URL}/assets/${id}`, {\n    method: \"PUT\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify(toSend)\n  });\n  if (!res.ok) throw new Error(\"Failed to update asset\");\n  const data = await res.json();\n  if (Array.isArray(data)) return data.map(mapOut);\n  if (data && data.value) return data.value.map(mapOut);\n  if (data && data.id) return mapOut(data);\n  return data;\n}","map":{"version":3,"names":["API_URL","mapStatusOut","s","_m$s","m","Open","Assigned","Closed","String","toLowerCase","mapStatusIn","_m$s2","active","maintenance","inactive","mapOut","item","_ref","_ref2","_item$openDate","_ref3","_item$closeDate","_ref4","_item$description","_ref5","_ref6","_item$id","openDate","open_date","open_date_time","closeDate","close_date","description","desc","id","asset_id","pk","status","listAssets","userEmail","url","encodeURIComponent","res","fetch","ok","Error","data","json","assets","Array","isArray","map","value","items","filter","a","email","addAsset","asset","toSend","type","location","method","headers","body","JSON","stringify","deleteAsset","updateAsset","patch","undefined"],"sources":["C:/Users/hussa/Desktop/ticketing/flowtrack/frontend/src/components/assetsApi.js"],"sourcesContent":["const API_URL = \"http://localhost:8000\"; // FastAPI backend base URL\r\n\r\n// Map backend status -> frontend status\r\nconst mapStatusOut = (s) => {\r\n  if (!s) return s;\r\n  const m = {\r\n    Open: \"active\",\r\n    Assigned: \"maintenance\",\r\n    Closed: \"inactive\",\r\n  };\r\n  return m[s] ?? String(s).toLowerCase();\r\n};\r\n\r\n// Map frontend status -> backend status\r\nconst mapStatusIn = (s) => {\r\n  if (!s) return s;\r\n  const m = {\r\n    active: \"Open\",\r\n    maintenance: \"Assigned\",\r\n    inactive: \"Closed\",\r\n  };\r\n  return m[s] ?? s;\r\n};\r\n\r\nconst mapOut = (item) => {\r\n  if (!item) return item;\r\n  // normalize field names to frontend expectations\r\n  const openDate = item.openDate ?? item.open_date ?? item.open_date_time ?? null;\r\n  const closeDate = item.closeDate ?? item.close_date ?? null;\r\n  const description = item.description ?? item.desc ?? null;\r\n  const id = item.id ?? item.asset_id ?? item.pk ?? null;\r\n  return {\r\n    ...item,\r\n    id,\r\n    status: mapStatusOut(item.status),\r\n    openDate,\r\n    closeDate,\r\n    description,\r\n  };\r\n};\r\n\r\nexport async function listAssets(userEmail = null) {\r\n  const url = userEmail\r\n    ? `${API_URL}/assets?user_email=${encodeURIComponent(userEmail)}`\r\n    : `${API_URL}/assets`;\r\n  const res = await fetch(url);\r\n  if (!res.ok) throw new Error(\"Failed to fetch assets\");\r\n  const data = await res.json();\r\n\r\n  // Backend may return either an array or an envelope { value: [...] }\r\n  let assets = [];\r\n  if (Array.isArray(data)) assets = data.map(mapOut);\r\n  else if (data && Array.isArray(data.value)) assets = data.value.map(mapOut);\r\n  // fallback: try common shapes\r\n  else if (data && Array.isArray(data.items)) assets = data.items.map(mapOut);\r\n\r\n  // Frontend safety filter by user email if provided\r\n  if (userEmail) {\r\n    assets = assets.filter(a => a.email === userEmail);\r\n  }\r\n  return assets;\r\n}\r\n\r\nexport async function addAsset(asset) {\r\n  // Send only the fields the backend schema expects (frontend status values)\r\n  const toSend = {\r\n    email: asset.email,\r\n    type: asset.type,\r\n    location: asset.location,\r\n    status: asset.status,\r\n    description: asset.description,\r\n  };\r\n\r\n  const res = await fetch(`${API_URL}/assets`, {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/json\" },\r\n    body: JSON.stringify(toSend),\r\n  });\r\n  if (!res.ok) throw new Error(\"Failed to add asset\");\r\n  const data = await res.json();\r\n  // normalize returned asset(s)\r\n  if (Array.isArray(data)) return data.map(mapOut);\r\n  if (data && data.value) return data.value.map(mapOut);\r\n  if (data && data.id) return mapOut(data);\r\n  return data;\r\n}\r\n\r\nexport async function deleteAsset(id) {\r\n  const res = await fetch(`${API_URL}/assets/${id}`, {\r\n    method: \"DELETE\",\r\n  });\r\n  if (!res.ok) throw new Error(\"Failed to delete asset\");\r\n  const data = await res.json();\r\n  return data;\r\n}\r\n\r\nexport async function updateAsset(id, patch) {\r\n  // Send only the fields expected by backend\r\n  const toSend = {\r\n    ...(patch.email !== undefined ? { email: patch.email } : {}),\r\n    ...(patch.type !== undefined ? { type: patch.type } : {}),\r\n    ...(patch.location !== undefined ? { location: patch.location } : {}),\r\n    ...(patch.status !== undefined ? { status: patch.status } : {}),\r\n    ...(patch.description !== undefined ? { description: patch.description } : {}),\r\n  };\r\n  const res = await fetch(`${API_URL}/assets/${id}`, {\r\n    method: \"PUT\",\r\n    headers: { \"Content-Type\": \"application/json\" },\r\n    body: JSON.stringify(toSend),\r\n  });\r\n  if (!res.ok) throw new Error(\"Failed to update asset\");\r\n  const data = await res.json();\r\n  if (Array.isArray(data)) return data.map(mapOut);\r\n  if (data && data.value) return data.value.map(mapOut);\r\n  if (data && data.id) return mapOut(data);\r\n  return data;\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}